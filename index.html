<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Whitegate Observatory</title>
<body style="font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:24px">
  <h1>Whitegate Weather</h1>
  <p style="color:#64748b;margin-top:-6px">Updates every ~4 hours.</p>

  <!-- Astro card -->
  <iframe id="astroFrame"
          src="astro/card.html?theme=auto&transparent=1&compact=0&radius=12"
          title="Astrophotography Outlook"
          scrolling="no"
          style="display:block;width:100%;border:0;overflow:hidden;border-radius:12px; height:520px;"></iframe>

  <!-- Weather: Whitegate -->
  <iframe id="wxWhitegate"
          src="weather/whitegate.html?theme=auto&transparent=1&radius=12"
          title="Whitegate 7-Day Weather"
          scrolling="no"
          style="display:block;width:100%;border:0;overflow:hidden;border-radius:12px;margin-top:16px; height:520px;"></iframe>

  <!-- Weather: Cork -->
  <iframe id="wxCork"
          src="weather/cork.html?theme=auto&transparent=1&radius=12"
          title="Cork 7-Day Weather"
          scrolling="no"
          style="display:block;width:100%;border:0;overflow:hidden;border-radius:12px;margin-top:16px; height:520px;"></iframe>

  <!-- Fishing forecast -->
  <iframe id="fishFrame"
          src="fishing/card.html?theme=auto&transparent=1&radius=12"
          title="Fishing Forecast"
          scrolling="no"
          style="display:block;width:100%;border:0;overflow:hidden;border-radius:12px;margin-top:16px; height:520px;"></iframe>

  <script>
    // Map each postMessage type to the correct iframe ID
    const frameByType = {
      'astro-card-size': 'astroFrame',
      'weather-whitegate-size': 'wxWhitegate',
      'weather-cork-size': 'wxCork',
      'fishing-card-size': 'fishFrame'
    };

    // Only apply height to the intended iframe; ignore others.
    window.addEventListener('message', function (e) {
      if (!e.data || typeof e.data.height !== 'number' || !e.data.type) return;
      const id = frameByType[e.data.type];
      if (!id) return;
      const f = document.getElementById(id);
      if (f) {
        // Clamp a bit so tiny cards don’t collapse
        const h = Math.max(120, e.data.height);
        if (f.style.height !== (h + 'px')) f.style.height = h + 'px';
      }
    });
  </script>

  <p style="color:#94a3b8;font-size:12px">Weather data © Meteosource • Tides © WorldTides</p>
</body>
</html>
