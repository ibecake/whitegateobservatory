<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Whitegate Observatory</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
      integrity="sha384-/NfFBlYXOsReRM7Qf3M3WyDiP6yQdlqzTeWY5Avzkdxl3pNGdisz8Iky3Uczdlz7"
      crossorigin="anonymous"
    />
    <style>
      body {
        font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
        background-color: #f8f9fb;
      }

      header.navbar {
        z-index: 1040;
      }

      .sidebar {
        min-height: 100vh;
        box-shadow: inset -1px 0 0 rgba(0, 0, 0, 0.05);
      }

      .sidebar .nav-link {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.65rem 1rem;
        font-weight: 500;
        color: #495057;
        border-radius: 0.75rem;
        transition: background-color 0.2s ease, color 0.2s ease;
      }

      .sidebar .nav-link .icon-wrapper {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 2rem;
        height: 2rem;
        border-radius: 0.75rem;
        background: rgba(13, 110, 253, 0.1);
        color: #0d6efd;
        font-size: 1.1rem;
      }

      .sidebar .nav-link:hover,
      .sidebar .nav-link:focus {
        background-color: rgba(13, 110, 253, 0.08);
        color: #0d6efd;
      }

      .sidebar .nav-link.active {
        background-color: rgba(13, 110, 253, 0.16);
        color: #0d6efd;
      }

      .sidebar .nav-link.active .icon-wrapper {
        background: #0d6efd;
        color: #ffffff;
      }

      .dashboard-overview .card {
        border: 0;
        border-radius: 1rem;
        box-shadow: 0 0.5rem 1rem rgba(15, 23, 42, 0.08);
      }

      .dashboard-overview .card-body {
        padding: 1.25rem 1.5rem;
      }

      .forecast-card {
        scroll-margin-top: 6rem;
      }

      .forecast-card .card {
        border: 0;
        border-radius: 1rem;
        box-shadow: 0 1.25rem 2.5rem -1rem rgba(15, 23, 42, 0.2);
        overflow: hidden;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .forecast-card .card:hover {
        transform: translateY(-4px);
        box-shadow: 0 1.75rem 3rem -1rem rgba(15, 23, 42, 0.25);
      }

      .forecast-card .card-header {
        background: linear-gradient(135deg, rgba(13, 110, 253, 0.12), rgba(13, 202, 240, 0.12));
        border-bottom: 0;
        padding: 1rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .forecast-card .card-header i {
        font-size: 1.35rem;
        color: #0d6efd;
      }

      .forecast-frame {
        width: 100%;
        border: 0;
        overflow: hidden;
        border-radius: 0.85rem;
        min-height: 320px;
        transition: box-shadow 0.2s ease-in-out;
        background-color: #ffffff;
      }

      .forecast-card .card-body {
        padding: 1.5rem;
        background-color: #ffffff;
      }

      .forecast-card .card-body:hover .forecast-frame {
        box-shadow: 0 0.75rem 2rem rgba(15, 23, 42, 0.15);
      }

      footer {
        color: #6c757d;
      }

      @media (max-width: 767.98px) {
        .sidebar {
          min-height: auto;
          box-shadow: none;
        }

        .forecast-card .card {
          box-shadow: 0 0.75rem 1.75rem -1rem rgba(15, 23, 42, 0.22);
        }
      }
    </style>
  </head>
  <body>
    <header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
      <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">
        Whitegate Observatory
      </a>
      <button
        class="navbar-toggler position-absolute d-md-none collapsed ms-2"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#sidebarMenu"
        aria-controls="sidebarMenu"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="navbar-nav flex-row flex-nowrap ms-auto">
        <div class="nav-item text-nowrap">
          <span class="nav-link px-3 text-light">
            Updated every ~4 hours
          </span>
        </div>
      </div>
    </header>

    <div class="container-fluid">
      <div class="row">
        <nav
          id="sidebarMenu"
          class="col-md-3 col-lg-2 d-md-block bg-white sidebar collapse px-3 py-4"
        >
          <div class="position-sticky top-0 pt-md-4">
            <p class="text-uppercase text-muted fw-semibold small mb-3">Forecasts</p>
            <ul class="nav flex-column gap-1">
              <li class="nav-item">
                <a class="nav-link" href="#astro">
                  <span class="icon-wrapper"><i class="bi bi-stars"></i></span>
                  Astrophotography Outlook
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#whitegate-weather">
                  <span class="icon-wrapper"><i class="bi bi-cloud-sun"></i></span>
                  Whitegate 7-Day Weather
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#cork-weather">
                  <span class="icon-wrapper"><i class="bi bi-cloud-rain"></i></span>
                  Cork 7-Day Weather
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#fishing">
                  <span class="icon-wrapper"><i class="bi bi-water"></i></span>
                  Fishing Forecast
                </a>
              </li>
            </ul>
          </div>
        </nav>

        <main
          class="col-md-9 ms-sm-auto col-lg-10 px-md-4 py-4 position-relative"
          data-bs-spy="scroll"
          data-bs-target="#sidebarMenu"
          data-bs-smooth-scroll="true"
          tabindex="0"
        >
          <div class="d-flex flex-wrap flex-md-nowrap align-items-center gap-3 pb-3 mb-4 border-bottom">
            <div>
              <h1 class="h2 mb-1">Forecast Dashboard</h1>
              <p class="text-muted mb-0">Monitor skies, weather, and tides for your next outing.</p>
            </div>
            <span class="badge bg-primary-subtle text-primary-emphasis ms-md-auto">
              Live feeds refresh automatically
            </span>
          </div>

          <div class="row row-cols-1 row-cols-xl-2 g-4 dashboard-overview mb-4">
            <div class="col">
              <div class="card h-100">
                <div class="card-body">
                  <h2 class="fs-6 text-uppercase text-muted mb-2">Astronomy Highlights</h2>
                  <p class="mb-0">
                    Use the Astrophotography outlook to spot upcoming clear-sky windows and optimal imaging hours.
                  </p>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card h-100">
                <div class="card-body">
                  <h2 class="fs-6 text-uppercase text-muted mb-2">Weather & Marine</h2>
                  <p class="mb-0">
                    Compare Whitegate and Cork forecasts side-by-side and plan coastal trips with the fishing feed.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="row row-cols-1 row-cols-xl-2 g-4">
            <section id="astro" class="col forecast-card">
              <div class="card h-100">
                <div class="card-header">
                  <i class="bi bi-stars"></i>
                  <div>
                    <h2 class="h5 mb-0">Astrophotography Outlook</h2>
                    <small class="text-muted">Sky quality, cloud cover, and imaging guidance</small>
                  </div>
                </div>
                <div class="card-body">
                  <iframe
                    id="astroFrame"
                    class="forecast-frame"
                    src="astro/card.html?theme=auto&transparent=1&compact=0&radius=12"
                    title="Astrophotography Outlook"
                    scrolling="no"
                  ></iframe>
                </div>
              </div>
            </section>

            <section id="whitegate-weather" class="col forecast-card">
              <div class="card h-100">
                <div class="card-header">
                  <i class="bi bi-cloud-sun"></i>
                  <div>
                    <h2 class="h5 mb-0">Whitegate 7-Day Weather</h2>
                    <small class="text-muted">Local temperature, wind, and precipitation trends</small>
                  </div>
                </div>
                <div class="card-body">
                  <iframe
                    id="wxWhitegate"
                    class="forecast-frame"
                    src="weather/whitegate.html?theme=auto&transparent=1&radius=12"
                    title="Whitegate 7-Day Weather"
                    scrolling="no"
                  ></iframe>
                </div>
              </div>
            </section>

            <section id="cork-weather" class="col forecast-card">
              <div class="card h-100">
                <div class="card-header">
                  <i class="bi bi-cloud-rain"></i>
                  <div>
                    <h2 class="h5 mb-0">Cork 7-Day Weather</h2>
                    <small class="text-muted">Regional overview for quick comparison</small>
                  </div>
                </div>
                <div class="card-body">
                  <iframe
                    id="wxCork"
                    class="forecast-frame"
                    src="weather/cork.html?theme=auto&transparent=1&radius=12"
                    title="Cork 7-Day Weather"
                    scrolling="no"
                  ></iframe>
                </div>
              </div>
            </section>

            <section id="fishing" class="col forecast-card">
              <div class="card h-100">
                <div class="card-header">
                  <i class="bi bi-water"></i>
                  <div>
                    <h2 class="h5 mb-0">Fishing Forecast</h2>
                    <small class="text-muted">Tide and bite conditions for coastal planning</small>
                  </div>
                </div>
                <div class="card-body">
                  <iframe
                    id="fishFrame"
                    class="forecast-frame"
                    src="fishing/card.html?theme=auto&transparent=1&radius=12"
                    title="Fishing Forecast"
                    scrolling="no"
                  ></iframe>
                </div>
              </div>
            </section>
          </div>

          <footer class="pt-5 small">
            Weather data © Meteosource • Tides © WorldTides
          </footer>
        </main>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <script>
      // Map each postMessage type to the correct iframe ID
      const frameByType = {
        "astro-card-size": "astroFrame",
        "weather-whitegate-size": "wxWhitegate",
        "weather-cork-size": "wxCork",
        "fishing-card-size": "fishFrame",
      };

      // Only apply height to the intended iframe; ignore others.
      window.addEventListener("message", (event) => {
        if (!event.data || typeof event.data.height !== "number" || !event.data.type) return;
        const id = frameByType[event.data.type];
        if (!id) return;
        const frame = document.getElementById(id);
        if (frame) {
          const height = Math.max(240, event.data.height);
          if (frame.style.height !== height + "px") {
            frame.style.height = height + "px";
          }
        }
      });

      // Activate scrollspy after the main content becomes available.
      document.addEventListener("DOMContentLoaded", () => {
        const main = document.querySelector("main[data-bs-spy='scroll']");
        if (main && window.bootstrap) {
          new window.bootstrap.ScrollSpy(main, {
            target: "#sidebarMenu",
            offset: 120,
          });
        }
      });
    </script>
  </body>
</html>
